#:import Factory kivy.factory.Factory

#:set buttonColor (0.08, 0.55, 1, 1)
#:set labelColor (0.95, 0.95, 0.96, 1)

#:set buttonSizer 20
#:set labelSizer 12

<MainLayout>:
    id: mainBox
    orientation: 'vertical'
    spacing: 10

    BoxLayout:
        id: navBar
        orientation: 'horizontal'
        size_hint: (1.0, 0.05)
        padding: (60, 0, 60, 0)

        Label:
            text: "[color=#FF970F][size=72][b]Some Logo[/b][/size][/color]"
            markup: True

        Button:
            id: openFile
            text: "Open File"

        Button:
            id: newFile
            text: "New File"

        Button:
            id: validation
            text: "Run Validation"

        Button:
            id: help
            text: "Help"

    BoxLayout:
        id: content
        orientation: 'horizontal'
        spacing: self.width / 20
        padding: (60, 15, 60, 30)

        BoxLayout:
            id: menu
            orientation: 'horizontal'
            spacing: self.width / 20

            BoxLayout:
                id: menuCol1
                orientation: 'vertical'
                spacing: self.height / 28

                Label:
                    text: "[b]Report\nHeader[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: labInfoButton
                    text: "[b]Lab Info &\nCal Notes[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: app.openLabInfoPop()

                Button:
                    id: restraintButton
                    text: "[b]Starting\nRestraint[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: app.openRestraintPop()

                Label:
                    text: "[b]Cal Setup[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: dateButton
                    text: "[b]Date,\nTechnition[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: app.openDatePop()

                Button:
                    id: balanceIDButton
                    text: "[b]Balance ID\nCheck ID[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: app.openBalanceIDPop()

                Button:
                    id: oldbalanceIDButton
                    text: "[b]Balance\nID[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: checkIDButton
                    text: "[b]Check\nID[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

            BoxLayout:
                id: menuCol2
                orientation: "vertical"
                spacing: self.height / 28

                Label:
                    text: "[b]Design[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: designIdButton
                    text: "[b]Design ID[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: numWeightsButton
                    text: "[b]# Positions[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: observationsButton
                    text: "[b]# Observations[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: designMatrixButton
                    text: "[b]Design Matrix[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: weightPositionsButton
                    text: "[b]Weight\nPositions[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Label:
                    text: "[b]Position\nVectors[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: restraintPositionButton
                    text: "[b]Restraint\nPosition[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: checkPositionButton
                    text: "[b]Check\nPosition[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: linearComboPositionButton
                    text: "[b]Linear Combo\nPosition[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: nextRestraintPositionButton
                    text: "[b]Next Restraint\nPosition[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

            BoxLayout:
                id: menuCol3
                orientation: "vertical"
                spacing: self.height / 28

                Label:
                    text: "[b]sw[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: swMassButton
                    text: "[b]sw Mass\n(mg)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: swDensityButton
                    text: "[b]sw Density\n(g/cm^3)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: swCCEButton
                    text: "[b]sw CCE\n(/" + u"\u00b0" +"C)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Label:
                    text: "[b]Statistics[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: sigmawButton
                    text: "[b]sw (mg)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: sigmatButton
                    text: "[b]st (mg)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Label:
                    text: "[b]Calibration\nData[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: balanceReadingsButton
                    text: "[b]Balance\nReadings[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: environmentalsButton
                    text: "[b]Environmentals[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: environmentalCorrectionsButton
                    text: "[b]Environmental\nCorrections[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

            BoxLayout:
                id: menuCol4
                orientation: "vertical"
                spacing: self.height / 28

                Button:
                    id: directReadingsButton
                    text: "[b]Direct Readings[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: directReadingsSFButton
                    text: "[b]Direct Readings\nSF (mg/div)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: nominalsInPoundsButton
                    text: "[b]Nominals In\nPounds?[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Label:
                    text: "[b]Optionals[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: gravityGradientButton
                    text: "[b]Gravity Gradient\n(s^-2)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Button:
                    id: comHeightsButton
                    text: "[b]COM Heights\n(cm)[/b]"
                    markup: True
                    background_normal: ''
                    background_color: buttonColor
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_press: root.addToTextBox(self)

                Label:
                    text: "[b]Actions[/b]"
                    markup: True
                    color: labelColor
                    font_size: dp(self.width / labelSizer)
                    halign: 'center'

                Button:
                    id: addSeriesButton
                    text: "[color=#FFFFFF][b]ADD\nSERIES[/b][/color]"
                    markup: True
                    background_normal: ''
                    background_color: (0.09, 0.64, 0.72, 0.95)
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'

                Button:
                    id: goToSeriesButton
                    text: "[color=#FFFFFF][b]GO TO\nSERIES[/b][/color]"
                    markup: True
                    background_normal: ''
                    background_color: (0.09, 0.64, 0.72, 0.95)
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'

                Button: 
                    id: saveButton
                    text: "[color=#000000][b]SAVE[/b][/color]"
                    markup: True
                    background_normal: ''
                    background_color: (1, 0.85, 0.02, 1)
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_release: root.save()

                Button:
                    id: runButton
                    text: "[color=#FFFFFF][b]RUN[/b][/color]"
                    markup: True
                    background_normal: ''
                    background_color: (0.62, 0.62, 0.62, 0.62)
                    font_size: dp(self.width / buttonSizer)
                    halign: 'center'
                    on_release: root.run()


        BoxLayout:
            id: textAreas
            orientation: "vertical"
            spacing: 20
            padding: (0, 0, 0, 0)

            TextInput:
                id: userText
                font_size: dp(12)
                padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
                background_normal: ''
                font_name: "./Menlo.ttc"
                text: "@Series\n"
                foreground_color: 0, 0, 0, 1
                markup: True
                on_focus: self.selection_color = 0.1843, 0.6549, 0.8313, 0.25
                on_text: root.textAdded()

            TextInput:
                id: errors
                font_size: dp(12)
                padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
                background_normal: ''
                font_name: "./Menlo.ttc"
                text: "ERRORS:"
                foreground_color: 0.9, 0.05, 0.05, 0.85
                size_hint: (1.0, 0.15)
                readonly: True

    Label:
        id: footer
        text: "[size=20]Copywrite Erik Alfvin, 2020[/size]"
        markup: True
        size_hint: (1.0, 0.01)

<LabInfoPopup>:
    id: labInfoPop
    auto_dismiss: False
    title: "Header Information"
    title_size: dp(18)
    size_hint: (0.5, 0.6)

    BoxLayout:
        id: LabInfoPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20        

        Label:
            text: "Laboratory Information & Notes:"
            size_hint: (1, 0.6)
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: labInfoText
            size_hint: (1, 2.2)
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "Calibration Laboratory\nAddress Line 1\nAddress Line 2\nAddress Line 3\nItem Description\nNotes"
            font_size: dp(15)
            padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
            background_normal: ''
            orderNum: 0

        Label:
            text: "Report Number:"
            size_hint: (1, 0.6)
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"

        OrderedText:
            id: reportNumText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "999999a"
            font_size: dp(15)
            background_normal: ''
            orderNum: 1

        Label:
            id: labInfoPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, 10)
            size_hint: (1, 0.74)

            Button:
                size_hint: (1, 1)
                text: "Save"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0, 0.6, 0.82, 1)
                halign: 'center'
                on_press: root.submit()

            Button:
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Cancel[/color]"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0.95, 0.1, 0.15, 0.95)
                halign: 'center'
                markup: True
                on_press: root.dismiss()

<RestraintPopup>:
    id: restraintPop
    auto_dismiss: False
    title: "Starting Restraint Information"
    title_size: dp(18)
    size_hint: (0.5, 0.6)

    BoxLayout:
        id: RestraintPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Restraint ID:"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: restraintIDText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "049"
            font_size: dp(15)
            background_normal: ''
            orderNum: 2

        Label:
            size_hint: (1, 0.6)
            text: "Restraint Uncertainty (mg):"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: restraintUncertaintyText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0.062"
            font_size: dp(15)
            background_normal: ''            
            orderNum: 3

        Label:
            size_hint: (1, 0.6)
            text: "Random Error (mg):"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: randomErrorText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: "0"
            hint_text: "0"
            font_size: dp(15)
            background_normal: ''
            orderNum: 4

        Label:
            id: restraintPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, 35)
            size_hint: (1, 0.95)

            Button:
                size_hint: (1, 1)
                text: "Save"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0, 0.6, 0.82, 1)
                halign: 'center'
                on_press: root.submit()

            Button:
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Cancel[/color]"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0.95, 0.1, 0.15, 0.95)
                halign: 'center'
                markup: True
                on_press: root.dismiss()

<DatePopup>:
    id: datePop
    auto_dismiss: False
    title: "Date, Technition ID"
    title_size: dp(18)
    size_hint: (0.5, 0.6)

    BoxLayout:
        id: datePLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Date:"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: dateText
            size_hint: (1, 0.3)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "MM DD YYYY"
            font_size: dp(15)
            background_normal: ''
            orderNum: 6

        Label:
            size_hint: (1, 0.6)
            text: "Technition ID:"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: techIDText
            size_hint: (1, 0.3)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "019"
            font_size: dp(15)
            background_normal: ''            
            orderNum: 7

        Label:
            id: datePopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, 35)
            size_hint: (1, 0.58)

            Button:
                size_hint: (1, 1)
                text: "Save"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0, 0.6, 0.82, 1)
                halign: 'center'
                on_press: root.submit()

            Button:
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Cancel[/color]"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0.95, 0.1, 0.15, 0.95)
                halign: 'center'
                markup: True
                on_press: root.dismiss()

<BalanceIDPopup>:
    id: balancePop
    auto_dismiss: False
    title: "Balance ID, Check ID"
    title_size: dp(18)
    size_hint: (0.5, 0.6)

    BoxLayout:
        id: balancePLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Balance ID:"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: balanceIDText
            size_hint: (1, 0.3)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "24"
            font_size: dp(15)
            background_normal: ''
            orderNum: 8

        Label:
            size_hint: (1, 0.6)
            text: "Check ID:"
            markup: True
            color: labelColor
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: checkIDText
            size_hint: (1, 0.3)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "62"
            font_size: dp(15)
            background_normal: ''            
            orderNum: 9

        Label:
            id: balancePopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: dp(self.width / (labelSizer*8))
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, 35)
            size_hint: (1, 0.58)

            Button:
                size_hint: (1, 1)
                text: "Save"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0, 0.6, 0.82, 1)
                halign: 'center'
                on_press: root.submit()

            Button:
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Cancel[/color]"
                font_size: dp(self.width / buttonSizer)
                background_normal: ''
                background_color: (0.95, 0.1, 0.15, 0.95)
                halign: 'center'
                markup: True
                on_press: root.dismiss()