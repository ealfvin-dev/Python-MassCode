#:import Factory kivy.factory.Factory

#:set labelColor (0.095, 0.095, 0.096, 0.9)
#:set popLabelColor (0.095, 0.095, 0.096, 0.9)
#:set buttonBlue (0.13, 0.5, 0.95, 0.94)

#:set buttonSizer 10
#:set menuButtonSizer 11
#:set labelSizer 1.23
#:set popUpFontSize sp(13)
#:set popUpLabelSize sp(15)

<MainLayout>:
    id: mainBox
    orientation: 'horizontal'
    spacing: self.size[1] / 50
    padding: 0, 0, 0, 0

    BoxLayout:
        id: menuCol1
        orientation: "vertical"
        spacing: 0
        padding: 0, 0, 0, 0
        size_hint: (0.13, 1.0)

        Button:
            id: addSeriesButton
            text: "[b]+[/b] Add Series"
            markup: True
            background_normal: ''
            background_color: (0.00, 0.76, 0.525, 1)
            font_size: self.width / buttonSizer
            halign: 'center'
            on_press: root.addSeries()

        SeriesButton:
            id: series1
            seriesNum: 1
            text: "[color=#000000]Series 1[/color]"
            font_size: self.width / menuButtonSizer
            background_color: (0.906, 0.918, 0.926, 1)
            exists: True
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series2
            seriesNum: 2
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series3
            seriesNum: 3
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series4
            seriesNum: 4
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series5
            seriesNum: 5
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series6
            seriesNum: 6
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series7
            seriesNum: 7
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series8
            seriesNum: 8
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series9
            seriesNum: 9
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series10
            seriesNum: 10
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series11
            seriesNum: 11
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series12
            seriesNum: 12
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series13
            seriesNum: 13
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: outputFileTab
            font_size: self.width / menuButtonSizer
            on_press: root.openOutputFile(self)

        Button:
            id: removeSeries
            text: "[color=#FFFFFF][b]-[/b] Remove\nLast Series[/color]"
            markup: True
            background_normal: ''
            background_color: (0.70, 0.135, 0.05, 0.92)
            font_size: self.width / (buttonSizer*1.1)
            halign: 'center'
            on_release: root.removeLastSeries()
            size_hint: (1, 0.85)

    BoxLayout:
        id: secondaryMainBox
        orientation: 'vertical'
        spacing: 5

        BoxLayout:
            id: navBar
            orientation: 'horizontal'
            size_hint: (1.0, 0.05)
            padding: (0, 0, 0, 0)

            Label:
                id: logo
                text: "[b]M A R S[/b]"
                markup: True
                color: labelColor
                font_size: self.width / 10

            TopMenuButton:
                id: openFile
                text: "Open File"
                on_release: app.openFilePop()

            TopMenuButton:
                id: searchDB
                text: "Search DB"

            TopMenuButton:
                id: newFile
                text: "New File"
                on_release: app.openNewFilePop()

            TopMenuButton:
                id: validation
                text: "Run Tests"
                on_release: app.openValidationPop()

            TopMenuButton:
                id: tutorial
                text: "Tutorial"

        BoxLayout:
            id: content
            orientation: 'horizontal'
            spacing: self.width / 15
            padding: (0, 10, 30, 30)

            BoxLayout:
                id: menu
                orientation: 'vertical'
                spacing: self.width / 50
                padding: (20, dp(13), 0, 0)

                BoxLayout:
                    id: menuLabel1
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nSeries 1 Header[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow1
                    orientation: 'horizontal'
                    spacing: self.width / 12
                    padding: (0, 0, 0, 20)

                    InputButton:
                        id: labInfoButton
                        text: "Report No.\nNotes"
                        font_size: self.width / buttonSizer
                        on_release: app.openLabInfoPop()

                    InputButton:
                        id: restraintButton
                        text: "Starting\nRestraint"
                        font_size: self.width / buttonSizer
                        on_release: app.openRestraintPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuLabel2
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nSeries Setup[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow2
                    orientation: 'horizontal'
                    spacing: self.width / 12
                    padding: (0, 0, 0, 20)

                    InputButton:
                        id: dateButton
                        text: "Date\nTechnicion"
                        font_size: self.width / buttonSizer
                        on_release: app.openDatePop()

                    InputButton:
                        id: balanceButton
                        text: "Balance"
                        font_size: self.width / buttonSizer
                        on_release: app.openBalancePop()

                    InputButton:
                        id: gravityButton
                        text: "Gravity\nGradient\n(Optional)"
                        background_color: (0.368, 0.49, 0.60, 1)
                        color: (1, 1, 1, 1)
                        font_size: self.width / buttonSizer
                        on_release: app.openGravityPop()

                BoxLayout:
                    id: menuLabel3
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nStatistics[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow3
                    orientation: 'horizontal'
                    spacing: self.width / 12
                    padding: (0, 0, 0, 20)

                    InputButton:
                        id: statisticsButton
                        text: "Statistics"
                        font_size: self.width / buttonSizer
                        on_release: app.openStatisticsPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuLabel4
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nDesign[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow4
                    orientation: 'horizontal'
                    spacing: self.width / 12
                    padding: (0, 0, 0, 20)

                    InputButton:
                        id: designButton
                        text: "Design"
                        font_size: self.width / buttonSizer
                        on_release: app.openDesignPop()

                    InputButton:
                        id: weightsButton
                        text: "Weights"
                        font_size: self.width / buttonSizer
                        on_release: app.openWeightsPop()

                    InputButton:
                        id: positionVectorsButton
                        text: "Position\nVectors"
                        font_size: self.width / buttonSizer
                        on_release: app.openVectorsPop()

                BoxLayout:
                    id: menuLabel5
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nMeasurement Data[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow5
                    orientation: 'horizontal'
                    spacing: self.width / 12
                    padding: (0, 0, 0, 20)

                    InputButton:
                        id: swButton
                        text: "Sensitivity\nWeight"
                        font_size: self.width / buttonSizer
                        on_release: app.openSwPop()

                    InputButton:
                        id: measurementsButton
                        text: "Measurements"
                        font_size: self.width / buttonSizer
                        on_release: app.openMeasurementsPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'left'

                BoxLayout:
                    id: menuRow6-blank
                    orientation: 'horizontal'
                    size_hint: (1, 0.75)

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'left'

                BoxLayout:
                    id: menuCol7
                    orientation: 'horizontal'
                    spacing: self.width / 12
                    padding: (0, 20, 0, 0)

                    Button: 
                        id: saveButton
                        text: "[color=#FFFFFF][b]SAVE[/b][/color]"
                        markup: True
                        background_normal: ''
                        background_color: (0.0314, 0.62, 0.165, 0.9)
                        font_size: self.width / (buttonSizer - 1)
                        halign: 'center'
                        on_release: root.save()

                    Button:
                        id: runButton
                        text: "[color=#FFFFFF][b]RUN[/b][/color]"
                        markup: True
                        background_normal: ''
                        background_color: (0.62, 0.62, 0.62, 0.62)
                        font_size: self.width / (buttonSizer - 1)
                        halign: 'center'
                        on_release: root.run()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'center'

            BoxLayout:
                id: textAreas
                orientation: "vertical"
                spacing: 12
                padding: (0, 0, 0, 0)
                size_hint: (1.5, 1.0)

                Label:
                    id: configFileName
                    font_size: dp(13)
                    text: ""
                    color: labelColor
                    text_size: userText.width, None
                    size: userText.width, self.texture_size[1]
                    halign: 'left'
                    size_hint: (1, 0.01)

                TextInput:
                    id: userText
                    font_size: '12sp'
                    padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
                    background_normal: ''
                    font_name: "./Menlo.ttc"
                    text: "@SERIES\n\n"
                    foreground_color: 0, 0, 0, 1
                    markup: True
                    on_focus: self.selection_color = 0.1843, 0.6549, 0.8313, 0.27
                    on_text: root.textAdded()

                TextInput:
                    id: errors
                    font_size: '12sp'
                    padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
                    background_normal: ''
                    font_name: "./Menlo.ttc"
                    text: ""
                    foreground_color: (0.9, 0.05, 0.05, 0.85)
                    size_hint: (1.0, 0.15)
                    readonly: True

        Label:
            id: footer
            font_size: dp(9)
            text: "[color=#000000]Copywrite Erik Alfvin, 2020[/color]"
            markup: True
            text_size: root.width, None
            size: self.texture_size
            halign: 'center'
            size_hint: (1.0, 0.01)

<LabInfoPopup>:
    id: labInfoPop
    auto_dismiss: False
    title: "Header"
    title_size: dp(18)
    size_hint: (0.42, 0.56)

    BoxLayout:
        id: LabInfoPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20        

        Label:
            text: "Laboratory Information & Notes:"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: labInfoText
            size_hint: (1, 2.2)
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "Calibration Laboratory\nAddress Line 1\nAddress Line 2\nAddress Line 3\nItem Description\nNotes"
            font_size: popUpFontSize
            padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
            background_normal: ''
            orderNum: 0
            write_tab: True

        Label:
            text: "Report Number:"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"

        OrderedText:
            id: reportNumText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "999999a"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 1

        Label:
            id: labInfoPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 17.5)
            size_hint: (1, 0.74)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<RestraintPopup>:
    id: restraintPop
    auto_dismiss: False
    title: "Starting Restraint Data"
    title_size: dp(18)
    size_hint: (0.42, 0.54)

    BoxLayout:
        id: RestraintPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Restraint ID:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: restraintIDText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "049"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 2

        Label:
            size_hint: (1, 0.6)
            text: "Restraint Uncertainty (mg):"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: restraintUncertaintyText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0.062"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 3

        Label:
            size_hint: (1, 0.6)
            text: "Random Error (mg):"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: randomErrorText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: "0"
            hint_text: "0"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 4

        Label:
            id: restraintPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.95)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<DatePopup>:
    id: datePop
    auto_dismiss: False
    title: "Date, IDs"
    title_size: dp(18)
    size_hint: (0.42, 0.54)

    BoxLayout:
        id: datePLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Date:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: dateText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "MM DD YYYY"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 6

        Label:
            size_hint: (1, 0.6)
            text: "Technicion ID:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: techIDText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "019"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 7

        Label:
            size_hint: (1, 0.6)
            text: "Check ID:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: checkIDText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "62"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 8

        Label:
            id: datePopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.95)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<BalancePopup>:
    id: balancePop
    auto_dismiss: False
    title: "Balance Data"
    title_size: dp(18)
    size_hint: (0.42, 0.54)

    BoxLayout:
        id: balancePLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Balance ID:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: balanceIDText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "049"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 9

        Label:
            size_hint: (1, 0.6)
            text: "Direct Readings (1 = Yes, 0 = No):"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: directReadingsText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: "0"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 10

        Label:
            size_hint: (1, 0.6)
            text: "Direct Reading Sensitivity Factor (mg/div):"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: directReadingsSFText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: "1.0"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 11

        Label:
            id: balancePopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.95)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<DesignPopup>:
    id: designPop
    auto_dismiss: False
    title: "Design"
    title_size: dp(18)
    size_hint: (0.42, 0.6)

    BoxLayout:
        id: designPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        BoxLayout:
            orientation: "horizontal"
            spacing: 25
            padding: 0, 0, 0, 0
            size_hint: (1, 2)

            BoxLayout:
                orientation: "vertical"
                spacing: 5
                padding: 0, 0, 0, 0

                Label:
                    id: designLabel
                    size_hint: (1, 0.6)
                    text: "Design Matrix:"
                    markup: True
                    color: popLabelColor
                    text_size: self.size
                    font_size: popUpLabelSize
                    halign: "left"
                    valign: "bottom"
                
                OrderedText:
                    id: designText
                    size_hint: (1, 2.5)
                    font_name: "./Menlo.ttc"
                    text: ""
                    hint_text: "1 -1  0  0\n1  0 -1  0\n1  0  0 -1\n0  1 -1  0\n0  1  0 -1\n0  0  1 -1"
                    font_size: popUpFontSize
                    padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
                    background_normal: ''
                    orderNum: 13
                    on_text: root.evalDesign()
                    write_tab: True

            BoxLayout:
                orientation: "vertical"
                spacing: 5
                padding: 0, designLabel.height + 5, 0, 0
                size_hint: (0.5, 1)

                Button:
                    id: dropDownMain
                    size_hint: (0.8, 0.5)
                    text: "Presets"
                    halign: 'center'
                    font_size: self.width / buttonSizer
                    on_release: dropDownn.open(self)

                DropDown:
                    id: dropDownn

                    Button:
                        text: "3-1"
                        size_hint_y: None
                        height: 60
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "4-1"
                        size_hint_y: None
                        height: 60
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "5-1"
                        size_hint_y: None
                        height: 60
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "532111"
                        size_hint_y: None
                        height: 60
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "522111"
                        size_hint_y: None
                        height: 60
                        on_press: root.writeDesign(self.text)

                Label:
                    id: positionsLabel
                    size_hint: (1, 0.6)
                    text: "Positions:"
                    markup: True
                    color: popLabelColor
                    text_size: self.size
                    font_size: mm(5)
                    halign: "left"
                    valign: "bottom"

                Label:
                    id: observationsLabel
                    size_hint: (1, 0.6)
                    text: "Observations:"
                    markup: True
                    color: popLabelColor
                    text_size: self.size
                    font_size: mm(5)
                    halign: "left"
                    valign: "bottom"

        Label:
            size_hint: (1, 0.6)
            text: "Design ID:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: designIDText
            size_hint: (1, 0.39)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "112"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 12

        Label:
            id: designPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.58)

            WriteButton:
                size_hint: (1, 1.5)
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                size_hint: (1, 1.5)
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<WeightsPopup>:
    id: weightsPop
    auto_dismiss: False
    title: "Weights"
    title_size: dp(18)
    size_hint: (0.42, 0.56)

    BoxLayout:
        id: weightsPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            text: "Weight Data - ID, Nominal (g/lb), Density, CCE (/" + chr(730) + "C), Correction (mg):"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: weightsText
            size_hint: (1, 2.2)
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "P1.kg     1000  7.9826  0.000045  2.345\nP1..kg    1000  7.9834  0.000045  1.824\nT1.kg     1000  8.0451  0.000045 \nT1..kg    1000  8.0405  0.000045"
            font_size: popUpFontSize
            padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
            background_normal: ''
            orderNum: 15
            write_tab: True

        Label:
            text: "Nominal Units (0 = g, 1 = lb):"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"

        OrderedText:
            id: nominalsText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: "0"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 14

        Label:
            id: weightsPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 17.5)
            size_hint: (1, 0.74)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<VectorsPopup>:
    id: vectorsPop
    auto_dismiss: False
    title: "Position Vectors"
    title_size: dp(18)
    size_hint: (0.42, 0.67)

    BoxLayout:
        id: vectorsPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "Restraint Position:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: restraintVectorText
            size_hint: (1, 0.45)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "1 1 0 0"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 16

        Label:
            size_hint: (1, 0.6)
            text: "Check Standard Position:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: checkVectorText
            size_hint: (1, 0.45)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "1 -1 0 0"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 17

        Label:
            size_hint: (1, 0.6)
            text: "Linear Combo Position:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: linearComboText
            size_hint: (1, 0.45)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0 0 0 0"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 18

        Label:
            size_hint: (1, 0.6)
            text: "Next Series Restraint:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: nextRestraintText
            size_hint: (1, 0.45)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0 0 0 0"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 19

        Label:
            id: vectorsPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.90)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<StatisticsPopup>:
    id: statisticsPop
    auto_dismiss: False
    title: "Statistics"
    title_size: dp(18)
    size_hint: (0.42, 0.44)

    BoxLayout:
        id: sigmaPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: chr(963) + "[size=3mm]t[/size] (mg):"
            markup: True
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: sigmatText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            hint_text: "0.008"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 20

        Label:
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: chr(963) + "[size=3mm]w[/size] (mg):"
            markup: True
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: sigmawText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            hint_text: "0.012"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 21

        Label:
            id: sigmaPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.95)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<SwPopup>:
    id: swPop
    auto_dismiss: False
    title: "Sensitivity Weight"
    title_size: dp(18)
    size_hint: (0.42, 0.54)

    BoxLayout:
        id: swPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            text: "sw True Mass (mg):"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: swMassText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "50.1023"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 22

        Label:
            size_hint: (1, 0.6)
            text: "sw Density:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: swDensityText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "7.95"
            font_size: popUpFontSize
            background_normal: ''            
            orderNum: 23

        Label:
            size_hint: (1, 0.6)
            text: "sw CCE:"
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: swCCEText
            size_hint: (1, 0.47)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0.000045"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 24

        Label:
            id: swPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.95)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<MeasurementsPopup>:
    id: measurementsPop
    auto_dismiss: False
    title: "Measurements"
    title_size: dp(18)
    size_hint: (0.42, 0.8)

    BoxLayout:
        id: measurementsPLayout
        orientation: "vertical"
        spacing: 5
        padding: 20, 0, 20, 20        

        Label:
            text: "Balance Readings:"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: balanceReadingsText
            size_hint: (1, 2.2)
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0     -0.61 19.42 20.02\n0.00  -0.59 19.42 20.03\n0.01  -0.51 19.51 20.02\n-0.60 -0.61 19.42 19.42"
            font_size: popUpFontSize
            padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
            background_normal: ''
            orderNum: 25
            write_tab: True

        Label:
            text: "Environmentals (" + chr(730) + "C, mmHg, %):"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"
        
        OrderedText:
            id: envText
            size_hint: (1, 2.2)
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "20.9 749.24 46.74\n20.8 749.26 46.81\n20.8 749.29 46.99\n20.9 749.31 47.11"
            font_size: popUpFontSize
            padding: [10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height, 10, 10 + 0.5 * (self.height - (10 + 10)) % self.line_height]
            background_normal: ''
            orderNum: 26
            write_tab: True

        Label:
            text: "Environmental Corrections (" + chr(730) + "C, mmHg, %):"
            size_hint: (1, 0.6)
            markup: True
            color: popLabelColor
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "bottom"

        OrderedText:
            id: envCorrectionsText
            size_hint: (1, 0.5)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            text: ""
            hint_text: "0.05 0.105 -0.07"
            font_size: popUpFontSize
            background_normal: ''
            orderNum: 27

        Label:
            id: measurementsPopError
            size_hint: (1, 0.6)
            text: ""
            markup: True
            color: (0.95, 0.05, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 17.5)
            size_hint: (1, 0.74)

            WriteButton:
                font_size: self.width / buttonSizer
                on_release: root.submit()

            CancelButton:
                font_size: self.width / buttonSizer
                on_release: root.dismiss()

<GravityPopup>:
    id: gravityPop
    auto_dismiss: False
    title: "Local Gravity Corrections"
    size: (dp(500), dp(560))

    BoxLayout:
        id: gravityPLayout
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Weight Heights (cm)"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            height: dp(200)
        
            OrderedText:
                id: heightText
                size_hint: (0.7, 1)
                hint_text: "10.3\n10.5\n14.0\n9.7"
                padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                orderNum: 30

            Label:
                id: gravityPositionsText
                size_hint: (0.3, None)
                height: heightText.height
                text_size: (self.width, self.height)
                text: "P1\nP1\nP3\nP1\nP1\nP6"
                color: popLabelColor
                font_size: sp(13)
                padding: (dp(5), dp(5) + 0.5 * (heightText.height - 2*dp(5)) % heightText.line_height)
                halign: "left"
                valign: "top"

        PopupLabel:
            text: "Gravity Gradient (1/s" + chr(178) + "):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: gradientText
            size_hint: (0.5, None)
            height: 3 * popUpFontSize
            multiline: False
            hint_text: "0.0000031"
            orderNum: 28

        PopupLabel:
            text: "Local Acceleration of\nGravity (m/s" + chr(178) + "):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: localGravityText
            size_hint: (0.5, None)
            height: 3 * popUpFontSize
            multiline: False
            hint_text: "9.8"
            orderNum: 29

        PopupLabel:
            id: gravityPopError
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)

            WriteButton:
                font_size: popUpLabelSize * 1.2
                on_release: root.submit()

            CancelButton:
                font_size: popUpLabelSize * 1.2
                on_release: root.dismiss()

<OpenFilePopup>:
    id: openFilePop
    auto_dismiss: False
    title: "Open File"
    title_size: dp(18)
    size_hint: (0.35, 0.32)

    BoxLayout:
        id: openFilePLayout
        orientation: "vertical"
        spacing: 35
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: "Enter Configuration File Name:"
            markup: True
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"
        
        TextInput:
            id: openFileText
            size_hint: (1, 0.44)
            multiline: False
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            hint_text: "12345-config.txt"
            font_size: popUpFontSize
            background_normal: ''

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.92)

            Button:
                size_hint: (1, 1)
                text: "Open"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.13, 0.5, 0.95, 0.94)
                halign: 'center'
                on_release: root.openFile(root.ids.openFileText.text.strip())

            Button:
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Cancel[/color]"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.70, 0.135, 0.05, 0.92)
                halign: 'center'
                markup: True
                on_release: root.dismiss()

<OpenNewFilePopup>:
    id: openNewFilePop
    auto_dismiss: True
    title: "Open New File"
    title_size: dp(18)
    size_hint: (0.35, 0.28)

    BoxLayout:
        id: openFilePLayout
        orientation: "vertical"
        spacing: 35
        padding: 20, 0, 20, 20

        Label:
            id: newFileMessage
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: ""
            markup: True
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.92)

            Button:
                id: openNewFileButton
                size_hint: (1, 1)
                text: ""
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.13, 0.5, 0.95, 0.94)
                halign: 'center'

            Button:
                id: cancelNewFileButton
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Cancel[/color]"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.70, 0.135, 0.05, 0.92)
                halign: 'center'
                markup: True
                on_release: root.dismiss()

<ValidationPopup>:
    id: validationPop
    auto_dismiss: False
    title: "Unit Testing"
    title_size: dp(18)
    size_hint: (0.45, 0.85)

    BoxLayout:
        id: validationPLayout
        orientation: "vertical"
        spacing: 15
        padding: 20, -1 * self.size[1]/15, 20, 20

        Label:
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: "Results:"
            markup: True
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"
        
        TextInput:
            id: validationText
            size_hint: (1, 2.75)
            multiline: True
            readonly: True
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            font_size: popUpFontSize
            background_normal: ''

        Label:
            id: testingMessage
            size_hint: (1, 0.2)
            text: ""
            markup: True
            color: (0.05, 0.95, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.50)

            Button:
                size_hint: (1, 1)
                text: "Close"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.13, 0.5, 0.95, 0.94)
                halign: 'center'
                markup: True
                on_release: root.dismiss()

            Label:
                size_hint: (1, 0.2)
                text: ""

<StartupTestsPopup>:
    id: StartupTestsPop
    auto_dismiss: False
    title: "Startup Tests"
    title_size: dp(18)
    size_hint: (0.35, 0.28)

    BoxLayout:
        id: startupTestsPLayout
        orientation: "vertical"
        spacing: 35
        padding: 20, 0, 20, 20

        Label:
            id: testStatus
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: "[b]Running startup tests...[/b]"
            markup: True
            color: (0.05, 0.95, 0.09, 0.9)
            text_size: self.size
            halign: "left"
            valign: "bottom"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.92)

            Button:
                id: openLogButton
                size_hint: (1, 1)
                text: "Open Log"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.62, 0.62, 0.62, 0.62)
                halign: 'center'

            Label:
                size_hint: (1, 1)
                text: ""

<RequestClosePopup>:
    id: RequestClosePop
    auto_dismiss: True
    title: "Close MARS"
    title_size: dp(18)
    size_hint: (0.35, 0.28)

    BoxLayout:
        id: RequestClosePlayout
        orientation: "vertical"
        spacing: root.height / 10
        padding: 20, 0, 20, 20

        Label:
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: "Close without saving input file?"
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.92)

            Button:
                size_hint: (1, 1)
                text: "Cancel"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.13, 0.5, 0.95, 0.94)
                halign: 'center'
                on_release: root.dismiss()

            Button:
                size_hint: (1, 1)
                text: "[color=#FFFFFF]Close Without\nSaving[/color]"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.70, 0.135, 0.05, 0.92)
                halign: 'center'
                markup: True
                on_release: app.closeApp()