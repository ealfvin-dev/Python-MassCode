#:import Factory kivy.factory.Factory

#:set labelColor (0.095, 0.095, 0.096, 0.9)
#:set popLabelColor (0.095, 0.095, 0.096, 0.9)
#:set buttonBlue (0.13, 0.5, 0.95, 0.94)

#:set buttonSizer 10
#:set menuButtonSizer 11
#:set labelSizer 1.23
#:set popUpFontSize sp(13)
#:set popUpLabelSize dp(15)

<MainLayout>:
    orientation: 'horizontal'
    spacing: self.size[1] / 50
    padding: 0, 0, 0, 0

    BoxLayout:
        id: menuCol1
        orientation: "vertical"
        spacing: 0
        padding: 0, 0, 0, 0
        size_hint: (0.13, 1.0)

        Button:
            id: addSeriesButton
            text: "[b]+[/b] Add Series"
            markup: True
            background_normal: ''
            background_color: (0.00, 0.76, 0.525, 1)
            font_size: self.width / buttonSizer
            halign: 'center'
            on_press: root.addSeries()

        SeriesButton:
            id: series1
            seriesNum: 1
            text: "[color=#000000]Series 1[/color]"
            font_size: self.width / menuButtonSizer
            background_color: (0.906, 0.918, 0.926, 1)
            exists: True
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series2
            seriesNum: 2
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series3
            seriesNum: 3
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series4
            seriesNum: 4
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series5
            seriesNum: 5
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series6
            seriesNum: 6
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series7
            seriesNum: 7
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series8
            seriesNum: 8
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series9
            seriesNum: 9
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series10
            seriesNum: 10
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series11
            seriesNum: 11
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series12
            seriesNum: 12
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: series13
            seriesNum: 13
            font_size: self.width / menuButtonSizer
            on_press: root.goToSeries(self.seriesNum, self.exists)

        SeriesButton:
            id: outputFileTab
            font_size: self.width / menuButtonSizer
            on_press: root.openOutputFile(self)

        Button:
            id: removeSeries
            text: "[color=#FFFFFF][b]-[/b] Remove\nLast Series[/color]"
            markup: True
            background_normal: ''
            background_color: (0.70, 0.135, 0.05, 0.92)
            font_size: self.width / (buttonSizer*1.1)
            halign: 'center'
            on_release: root.removeLastSeries()
            size_hint: (1, 0.85)

    BoxLayout:
        id: secondaryMainBox
        orientation: 'vertical'
        spacing: dp(2)

        BoxLayout:
            id: navBar
            orientation: 'horizontal'
            size_hint: (1.0, 0.05)
            padding: (0, 0, 0, 0)

            Label:
                id: logo
                text: "[b]M A R S[/b]"
                markup: True
                color: labelColor
                font_size: self.width / 10

            TopMenuButton:
                id: openFile
                text: "Open File"
                on_release: app.openFilePop()

            TopMenuButton:
                id: searchDB
                text: "Search DB"

            TopMenuButton:
                id: newFile
                text: "New File"
                on_release: app.openNewFilePop()

            TopMenuButton:
                id: validation
                text: "Run Tests"
                on_release: app.openValidationPop()

            TopMenuButton:
                id: tutorial
                text: "Tutorial"

        BoxLayout:
            id: content
            orientation: 'horizontal'
            spacing: self.width / 15
            padding: (0, dp(5), dp(15), dp(15))

            BoxLayout:
                id: menu
                orientation: 'vertical'
                spacing: self.width / 50
                padding: (dp(10), dp(13), 0, 0)

                BoxLayout:
                    id: menuLabel1
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nSeries 1 Header[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow1
                    orientation: 'horizontal'
                    spacing: self.width / 10
                    padding: (0, 0, 0, dp(10))

                    InputButton:
                        id: labInfoButton
                        text: "Report No.\nNotes"
                        font_size: self.width / buttonSizer
                        on_release: app.openLabInfoPop()

                    InputButton:
                        id: restraintButton
                        text: "Series 1\nRestraint"
                        font_size: self.width / buttonSizer
                        on_release: app.openRestraintPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: headerSeparater-blank
                    orientation: 'horizontal'
                    size_hint: (1, 0.4)

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'left'

                BoxLayout:
                    id: menuLabel2
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nSeries Setup[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow2
                    orientation: 'horizontal'
                    spacing: self.width / 10
                    padding: (0, 0, 0, dp(10))

                    InputButton:
                        id: dateButton
                        text: "Balance &\nDate"
                        font_size: self.width / buttonSizer
                        on_release: app.openDatePop()

                    InputButton:
                        id: weightsButton
                        text: "Weights"
                        font_size: self.width / buttonSizer
                        on_release: app.openWeightsPop()

                    InputButton:
                        id: gravityButton
                        text: "Gravity\nGradient\n(Optional)"
                        background_color: (0.368, 0.49, 0.60, 1)
                        color: (1, 1, 1, 1)
                        font_size: self.width / buttonSizer
                        on_release: app.openGravityPop()

                BoxLayout:
                    id: menuLabel3
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nDesign[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow3
                    orientation: 'horizontal'
                    spacing: self.width / 10
                    padding: (0, 0, 0, dp(10))

                    InputButton:
                        id: designButton
                        text: "Design"
                        font_size: self.width / buttonSizer
                        on_release: app.openDesignPop()

                    InputButton:
                        id: positionVectorsButton
                        text: "Position\nVectors"
                        font_size: self.width / buttonSizer
                        on_release: app.openVectorsPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuLabel4
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nStatistics[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow4
                    orientation: 'horizontal'
                    spacing: self.width / 10
                    padding: (0, 0, 0, dp(10))

                    InputButton:
                        id: statisticsButton
                        text: "Statistics"
                        font_size: self.width / buttonSizer
                        on_release: app.openStatisticsPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuLabel5
                    orientation: 'horizontal'
                    size_hint: (1.0, 0.25)

                    Label:
                        text: "[b]\nMeasurement Data[/b]"
                        markup: True
                        color: labelColor
                        font_size: self.height / labelSizer
                        text_size: self.size
                        halign: 'left'

                BoxLayout:
                    id: menuRow5
                    orientation: 'horizontal'
                    spacing: self.width / 10
                    padding: (0, 0, 0, dp(10))

                    InputButton:
                        id: swButton
                        text: "Sensitivity\nWeight"
                        font_size: self.width / buttonSizer
                        on_release: app.openSwPop()

                    InputButton:
                        id: measurementsButton
                        text: "Measurements"
                        font_size: self.width / buttonSizer
                        on_release: app.openMeasurementsPop()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'left'

                BoxLayout:
                    id: menuRow6-blank
                    orientation: 'horizontal'
                    size_hint: (1, 0.75)

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'left'

                BoxLayout:
                    id: menuCol7
                    orientation: 'horizontal'
                    spacing: self.width / 10
                    padding: (0, dp(10), 0, 0)

                    Button: 
                        id: saveButton
                        text: "[color=#FFFFFF][b]SAVE[/b][/color]"
                        markup: True
                        background_normal: ''
                        background_color: (0.0314, 0.62, 0.165, 0.9)
                        font_size: self.width / (buttonSizer - 1)
                        halign: 'center'
                        on_release: root.save()

                    Button:
                        id: runButton
                        text: "[color=#FFFFFF][b]RUN[/b][/color]"
                        markup: True
                        background_normal: ''
                        background_color: (0.62, 0.62, 0.62, 0.62)
                        font_size: self.width / (buttonSizer - 1)
                        halign: 'center'
                        on_release: root.run()

                    Label:
                        text: ""
                        color: labelColor
                        font_size: self.height / labelSizer
                        halign: 'center'

            BoxLayout:
                id: textAreas
                orientation: "vertical"
                spacing: dp(6)
                padding: (0, 0, 0, 0)
                size_hint: (1.5, 1.0)

                Label:
                    id: configFileName
                    font_size: dp(13)
                    text: ""
                    color: labelColor
                    text_size: userText.width, None
                    size: userText.width, self.texture_size[1]
                    halign: 'left'
                    size_hint: (1, 0.01)

                UserInput:
                    id: userText
                    font_size: '12sp'
                    padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                    background_normal: ''
                    font_name: "./Menlo.ttc"
                    text: "@SERIES\n\n"
                    foreground_color: 0, 0, 0, 1
                    markup: True
                    on_focus: self.selection_color = 0.1843, 0.6549, 0.8313, 0.27
                    on_text: root.textAdded(self.cursor_row)

                TextInput:
                    id: errors
                    font_size: '12sp'
                    padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                    background_normal: ''
                    background_active: ''
                    font_name: "./Menlo.ttc"
                    text: ""
                    foreground_color: (0.9, 0.05, 0.05, 0.85)
                    size_hint: (1.0, 0.15)
                    readonly: True

        Label:
            font_size: dp(9)
            text: "[color=#000000]Copywrite Erik Alfvin, 2020[/color]"
            markup: True
            text_size: root.width, None
            size: self.texture_size
            halign: 'center'
            size_hint: (1.0, 0.01)

<LabInfoPopup>:
    auto_dismiss: False
    title: "Header"
    size: (dp(600), dp(475))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Laboratory Information & Notes:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: labInfoText
            size_hint: (1, None)
            hint_text: "Calibration Laboratory\nAddress Line 1\nAddress Line 2\nAddress Line 3\nItem Description\nNotes"
            padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
            write_tab: True
            multiline: True
            height: dp(200)
            orderNum: 0

        PopupLabel:
            text: "Report Number:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: reportNumText
            size_hint: (0.5, None)
            height: 3 * popUpFontSize
            hint_text: "999999a"
            orderNum: 1

        PopupLabel:
            id: labInfoPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<RestraintPopup>:
    auto_dismiss: False
    title: "Series 1 Restraint Data"
    size: (dp(400), dp(380))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Restraint ID:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: restraintIDText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "049"
            orderNum: 2

        PopupLabel:
            text: "Restraint Uncertainty (mg):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: restraintUncertaintyText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "0.062"
            orderNum: 3

        PopupLabel:
            text: "Random Error (mg):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: randomErrorText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            text: "0"
            hint_text: "0"
            orderNum: 4

        PopupLabel:
            id: restraintPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<DatePopup>:
    auto_dismiss: False
    title: "Date, Balance"
    size: (dp(570), dp(410))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(20)
            height: dp(230)

            BoxLayout:
                orientation: "vertical"
                size_hint: (0.5, None)
                spacing: dp(8)
                padding: dp(10), dp(10), dp(10), dp(10)

                PopupLabel:
                    text: "Date:"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

                OrderedText:
                    id: dateText
                    size_hint: (1, None)
                    height: 3 * popUpFontSize
                    hint_text: "MM DD YYYY"
                    orderNum: 6

                PopupLabel:
                    text: "Technician ID:"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

                OrderedText:
                    id: techIDText
                    size_hint: (1, None)
                    height: 3 * popUpFontSize
                    hint_text: "019"
                    orderNum: 7

                PopupLabel:
                    text: ""
                    size_hint: (1, None)
                    height: SFLabel.height
                    text_size: (self.width, None)

                PopupLabel:
                    text: ""
                    size_hint: (1, None)
                    height: techIDText.height
                    text_size: (self.width, None)

            BoxLayout:
                orientation: "vertical"
                size_hint: (0.5, None)
                spacing: dp(8)
                padding: dp(10), dp(10), dp(10), dp(10)

                PopupLabel:
                    text: "Balance ID:"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

                OrderedText:
                    id: balanceIDText
                    size_hint: (1, None)
                    height: 3 * popUpFontSize
                    hint_text: "14"
                    orderNum: 8

                PopupLabel:
                    text: "Direct Readings (1 = Yes, 0 = No):"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

                OrderedText:
                    id: directReadingsText
                    size_hint: (1, None)
                    height: 3 * popUpFontSize
                    text: "0"
                    hint_text: "0"
                    orderNum: 9

                PopupLabel:
                    id: SFLabel
                    text: "Direct Reading Sensitivity Factor\n(mg/div):"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

                OrderedText:
                    id: directReadingsSFText
                    size_hint: (1, None)
                    height: 3 * popUpFontSize
                    text: "1.0"
                    hint_text: "1.0"
                    orderNum: 10

        PopupLabel:
            id: datePopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<DesignPopup>:
    auto_dismiss: False
    title: "Design"
    size: (dp(570), dp(550))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Design Matrix:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(20)
            height: dp(280)

            OrderedText:
                id: designText
                size_hint: (0.7, 1)
                hint_text: "1 -1  0  0\n1  0 -1  0\n1  0  0 -1\n0  1 -1  0\n0  1  0 -1\n0  0  1 -1"
                padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                write_tab: True
                multiline: True
                on_text: root.evalDesign()
                orderNum: 18

            BoxLayout:
                orientation: "vertical"
                spacing: dp(50)
                size_hint: (0.3, 1)

                Button:
                    id: dropDownMain
                    size_hint: (None, None)
                    size: (dp(140), dp(50))
                    text: "Presets"
                    halign: 'center'
                    font_size: dp(15)
                    on_release: dropDownn.open(self)

                DropDown:
                    id: dropDownn

                    Button:
                        text: "3-1"
                        size_hint_y: None
                        height: dp(30)
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "4-1"
                        size_hint_y: None
                        height: dp(30)
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "5-1"
                        size_hint_y: None
                        height: dp(30)
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "532111"
                        size_hint_y: None
                        height: dp(30)
                        on_press: root.writeDesign(self.text)

                    Button:
                        text: "522111"
                        size_hint_y: None
                        height: dp(30)
                        on_press: root.writeDesign(self.text)

                PopupLabel:
                    id: positionsLabel
                    text: "Positions:"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

                PopupLabel:
                    id: observationsLabel
                    text: "Observations:"
                    size_hint: (1, None)
                    height: self.texture_size[1]
                    text_size: (self.width, None)

        PopupLabel:
            text: "Design ID:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: designIDText
            size_hint: (0.4, None)
            height: 3 * popUpFontSize
            hint_text: "112"
            orderNum: 17

        PopupLabel:
            id: designPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<WeightsPopup>:
    auto_dismiss: False
    title: "Weights"
    size: (dp(600), dp(495))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Weight Data:\nID  |  Nominal (g, lb)  |  Density (g/cm3)  |  CCE (/" + chr(730) + "C)  |  Correction (mg):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: weightsText
            size_hint: (1, None)
            hint_text: "P1.kg     1000  7.9826  0.000045  2.345\nP1..kg    1000  7.9834  0.000045  1.824\nT1.kg     1000  8.0451  0.000045 \nT1..kg    1000  8.0405  0.000045"
            padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
            write_tab: True
            multiline: True
            height: dp(200)
            orderNum: 16

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(20)
            height: dp(20)

            PopupLabel:
                text: "Nominal Units (1 = g, 0 = lb):"
                size_hint: (0.5, None)
                height: self.texture_size[1]
                text_size: (self.width, None)

            PopupLabel:
                text: "Check Standard ID:"
                size_hint: (0.5, None)
                height: self.texture_size[1]
                text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(20)
            height: dp(42)

            OrderedText:
                id: nominalsText
                size_hint: (0.5, None)
                height: 3 * popUpFontSize
                hint_text: "1"
                text: "1"
                orderNum: 15

            OrderedText:
                id: checkIDText
                size_hint: (0.5, None)
                height: 3 * popUpFontSize
                hint_text: "54"
                orderNum: 14

        PopupLabel:
            id: weightsPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<VectorsPopup>:
    auto_dismiss: False
    title: "Position Vectors"
    size: (dp(400), dp(380))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)
            
        PopupLabel:
            text: "Restraint Position:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: restraintVectorText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "1 1 0 0"
            orderNum: 19

        PopupLabel:
            text: "Check Standard Position:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: checkVectorText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "1 -1 0 0"
            orderNum: 20

        PopupLabel:
            text: "Next Series Restraint:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: nextRestraintText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "0 0 0 0"
            orderNum: 21

        PopupLabel:
            id: vectorsPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<StatisticsPopup>:
    auto_dismiss: False
    title: "Statistics"
    size: (dp(400), dp(310))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: chr(963) + "[size=3mm]t[/size] (mg):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: sigmatText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "0.008"
            orderNum: 22

        PopupLabel:
            text: chr(963) + "[size=3mm]w[/size] (mg):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: sigmawText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "0.012"
            orderNum: 23

        PopupLabel:
            id: sigmaPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<SwPopup>:
    auto_dismiss: False
    title: "Sensitivity Weight"
    size: (dp(400), dp(380))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "sw True Mass (mg):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: swMassText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "50.1023"
            orderNum: 24

        PopupLabel:
            text: "sw Density (g/cm3):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: swDensityText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "7.95"
            orderNum: 25

        PopupLabel:
            text: "sw CCE (/" + chr(730) + "C):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: swCCEText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "0.000045"
            orderNum: 26

        PopupLabel:
            id: swPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<MeasurementsPopup>:
    auto_dismiss: False
    title: "Measurements"
    size: (dp(800), dp(540))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(12)
            height: dp(20)

            PopupLabel:
                text: "Balance Readings:"
                size_hint: (0.65, None)
                height: self.texture_size[1]
                text_size: (self.width, None)

            PopupLabel:
                text: "Environmentals (" + chr(730) + "C, mmHg, %):"
                size_hint: (0.35, None)
                height: self.texture_size[1]
                text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(12)
            height: dp(240)
            
            OrderedText:
                id: balanceReadingsText
                size_hint: (0.65, 1)
                hint_text: "0     -0.61 19.42 20.02\n0.00  -0.59 19.42 20.03\n0.01  -0.51 19.51 20.02\n-0.60 -0.61 19.42 19.42"
                padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                write_tab: True
                multiline: True
                orderNum: 29
            
            OrderedText:
                id: envText
                size_hint: (0.35, 1)
                hint_text: "20.9 749.24 46.74\n20.8 749.26 46.81\n20.8 749.29 46.99\n20.9 749.31 47.11"
                padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                write_tab: True
                multiline: True
                orderNum: 27

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(12)
            height: dp(40)

            Label:
                size_hint: (0.65, None)
                text: ""
                height: self.texture_size[1]

            PopupLabel:
                text: "Environmental Corrections\n(" + chr(730) + "C, mmHg, %):"
                size_hint: (0.35, None)
                height: self.texture_size[1]
                text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            spacing: dp(12)
            height: dp(42)

            Label:
                size_hint: (0.65, None)
                text: ""
                height: self.texture_size[1]

            OrderedText:
                id: envCorrectionsText
                size_hint: (0.35, None)
                height: 3 * popUpFontSize
                hint_text: "0.05 0.105 -0.07"
                orderNum: 28

        PopupLabel:
            id: measurementsPopError
            size_hint: (1, None)
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<GravityPopup>:
    auto_dismiss: False
    title: "Local Gravity Corrections"
    size: (dp(500), dp(560))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Weight Heights (cm)"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            size_hint: (1, None)
            height: dp(200)
        
            OrderedText:
                id: heightText
                size_hint: (0.7, 1)
                hint_text: "10.3\n10.5\n14.0\n9.7"
                multiline: True
                padding: [dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height, dp(5), dp(5) + 0.5 * (self.height - 2*dp(5)) % self.line_height]
                orderNum: 13

            Label:
                id: gravityPositionsText
                size_hint: (0.3, None)
                height: heightText.height
                text_size: (self.width, self.height)
                text: "P1\nP1\nP3\nP1\nP1\nP6"
                color: popLabelColor
                font_size: dp(13)
                padding: (dp(5), dp(5) + 0.5 * (heightText.height - 2*dp(5)) % heightText.line_height)
                halign: "left"
                valign: "top"

        PopupLabel:
            text: "Gravity Gradient (1/s" + chr(178) + "):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: gradientText
            size_hint: (0.5, None)
            height: 3 * popUpFontSize
            hint_text: "0.0000031"
            orderNum: 11

        PopupLabel:
            text: "Local Acceleration of\nGravity (m/s" + chr(178) + "):"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)

        OrderedText:
            id: localGravityText
            size_hint: (0.5, None)
            height: 3 * popUpFontSize
            hint_text: "9.8"
            orderNum: 12

        PopupLabel:
            id: gravityPopError
            text: ""
            color: (0.95, 0.05, 0.09, 1)
            size_hint: (1, None)
            height: dp(20)
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(50)

            CancelButton:
                on_release: root.dismiss()

            WriteButton:
                on_release: root.submit()

<OpenFilePopup>:
    auto_dismiss: False
    title: "Open File"
    title_size: dp(18)
    size_hint: (None, None)
    size: (dp(520), dp(250))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(8)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            id: configFileLabel
            text: "Enter Configuration File Name:"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)
            color: root.title_color

        OrderedText:
            id: openFileText
            size_hint: (1, None)
            height: 3 * popUpFontSize
            hint_text: "999999a-config.txt"
            orderNum: 999

        PopupLabel:
            text: ""
            size_hint: (1, None)
            height: configFileLabel.height
            text_size: (self.width, None)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(60)

            WriteButton:
                text: "Open"
                size: (dp(150), dp(55))
                on_release: root.openFile(root.ids.openFileText.text.strip())

            CancelButton:
                size: (dp(150), dp(55))
                on_release: root.dismiss()

<OpenNewFilePopup>:
    auto_dismiss: True
    title: "Open New File"
    title_size: dp(18)
    size_hint: (None, None)
    size: (dp(520), dp(250))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(50)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            id: newFileMessage
            text: ""
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)
            color: root.title_color
            halign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(60)

            WriteButton:
                id: openNewFileButton
                text: ""
                size: (dp(150), dp(55))

            CancelButton:
                id: cancelNewFileButton
                size: (dp(150), dp(55))
                on_release: root.dismiss()

<ValidationPopup>:
    auto_dismiss: False
    title: "Unit Testing"
    title_size: dp(18)
    size_hint: (0.45, 0.85)

    BoxLayout:
        orientation: "vertical"
        spacing: 15
        padding: 20, -1 * self.size[1]/15, 20, 20

        Label:
            size_hint: (1, 0.6)
            font_size: popUpLabelSize
            text: "Results:"
            markup: True
            color: popLabelColor
            text_size: self.size
            halign: "left"
            valign: "bottom"
        
        TextInput:
            id: validationText
            size_hint: (1, 2.75)
            multiline: True
            readonly: True
            padding: [10, 10, 10, 10]
            font_name: "./Menlo.ttc"
            font_size: popUpFontSize
            background_normal: ''

        Label:
            id: testingMessage
            size_hint: (1, 0.2)
            text: ""
            markup: True
            color: (0.05, 0.95, 0.09, 1)
            text_size: self.size
            font_size: popUpLabelSize
            halign: "left"
            valign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: root.width / 3
            padding: (0, self.height / 5)
            size_hint: (1, 0.50)

            Button:
                size_hint: (1, 1)
                text: "Close"
                font_size: self.width / buttonSizer
                background_normal: ''
                background_color: (0.13, 0.5, 0.95, 0.94)
                halign: 'center'
                markup: True
                on_release: root.dismiss()

            Label:
                size_hint: (1, 0.2)
                text: ""

<StartupTestsPopup>:
    auto_dismiss: False
    title: "Startup Tests"
    title_size: dp(18)
    size_hint: (None, None)
    size: (dp(520), dp(250))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(50)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            id: testStatus
            text: "[b]Running startup tests...[/b]"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)
            color: (0.05, 0.95, 0.09, 0.9)

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(60)

            WriteButton:
                id: openLogButton
                text: "Open Log"
                size: (dp(150), dp(55))
                background_color: (0.62, 0.62, 0.62, 0.62)

            PopupLabel:
                text: ""
                size_hint: (1, None)
                height: openLogButton.height
                text_size: (self.width, None)

<RequestClosePopup>:
    auto_dismiss: True
    title: "Close MARS"
    title_size: dp(18)
    size_hint: (None, None)
    size: (dp(520), dp(250))

    BoxLayout:
        orientation: "vertical"
        spacing: dp(50)
        padding: dp(10), dp(10), dp(10), dp(10)

        PopupLabel:
            text: "Close without saving input file?"
            size_hint: (1, None)
            height: self.texture_size[1]
            text_size: (self.width, None)
            color: root.title_color
            halign: "center"

        BoxLayout:
            orientation: "horizontal"
            spacing: self.width - 2*dp(150)
            size_hint: (1, None)
            height: dp(60)

            WriteButton:
                text: "Cancel"
                size: (dp(150), dp(55))
                on_release: root.dismiss()

            CancelButton:
                text: "Close Without\nSaving"
                size: (dp(150), dp(55))
                on_release: app.closeApp()